#!/usr/bin/env python

import bdkd.datastore
import json, optparse

def main():
    usage = "usage: %prog [options] 'repository' 'resource name'"
    optparser = optparse.OptionParser(usage=usage)
    (options, args) = optparser.parse_args()

    if len(args) < 2:
        optparser.error("Need to provide a repository and a resource name")

    # Repository
    repository_name = args.pop(0)
    repository = bdkd.datastore.repository(repository_name)
    if not repository:
        optparser.error("The repository '{0}' is not valid or not configured"
                .format(repository_name))

    # Resource
    resource_name = args.pop(0)
    resource = repository.get(resource_name)
    if resource:
        paths = resource.local_paths()
        for path in paths:
            print path

if __name__ == "__main__":
    main()


